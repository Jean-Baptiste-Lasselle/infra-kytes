#!/bin/bash


# TODO ==>>>>>>>> Ce script devra avoir un argument : le UUID du disque dur externe qui sert au backup
#                      le UUID enregistré une première fois pour le disque dur externe SEAGATE : 70BE639EBE635B9A


# 1. je veux récupérer le UUID de mon disque dur externe "Seagate". TOut ce que je sais, c'est qu'il y a un genre de label sur le disque, incluant le mot [Seagate]

export UUID_DE_MON_DISQUE_DUR_EXTERNE=70BE639EBE635B9A
export UUID_DE_MON_DISQUE_DUR_EXTERNE=$1


# 2. Je veux créer le répertoire surlequel je vais monter le disque dur externe: Ce répertoire sera différent à chaque backup, il ne sera jamais le même, par sécurité.
export REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE=$2
export TYPE_DU_SYSTEME_DE_FICHIERS=$3

# TODO : rajuter des contrôlmes, comme quoi il y a bientrois arguements,k et que le troisème a pour valeur l'une des possiblités suivantes : 
#   =>  ext3
#   =>  ext4
#   =>  ntfs-3g

echo "  "
echo "  "
echo "  Verif  [\$1=$1] "
echo "  Verif  [UUID_DE_MON_DISQUE_DUR_EXTERNE=$UUID_DE_MON_DISQUE_DUR_EXTERNE] "
echo "  "
echo "  Verif  [\$2=$2] "
echo "  Verif  [REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE=$REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE] "
echo "  "
echo "  Verif  [\$3=$3] "
echo "  Verif  [TYPE_DU_SYSTEME_DE_FICHIERS=$TYPE_DU_SYSTEME_DE_FICHIERS] "
echo "  "
echo "  "
read ATTENDS

# Avant toute opération, je commence par démonter le disque potentiellement monté, quelque soit son point de montage
sudo umount UUID=$UUID_DE_MON_DISQUE_DUR_EXTERNE
# Je créée mon répertoire, en le détruisant d'abord, s'il existe  
if [ -d $REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE ]; then
  echo "Le répertoire $REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE exite, il va être détruit, pour être re-créé "
  echo " Pressez la touche clavier Entrée, pour continuer "
  # read REP_DETRUIT_RECREE
  sudo rm -rf $REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE
fi
# Salut biloute
mkdir -p $REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE

echo " AVANT MONTAGE DISQUE DUR EXTERNE, VERIFICATION CONTENU [REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE=$REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE] "
echo " Pressez la touche clavier Entrée, pour continuer "
# read REP_REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE




# 3. Enfin, on remonte le disque dur externe, sur la base de son UUID
sudo mount -t $TYPE_DU_SYSTEME_DE_FICHIERS UUID=$UUID_DE_MON_DISQUE_DUR_EXTERNE $REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE


# 4. Parfait, je suis maintenant prêt pour balancer mon backup au niveau applis (l'utilisateur du script se voit retourné le chemin du répertoire danslequel stocker le backup)
echo "  "
echo "Le répertoire [$REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE] a été créé avec succès, et le disque y a été monté"
echo " Contenu du répertoire [$REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE] : "
echo "  "
ls -allh $REPERTOIRE_DE_MONTAGE_DISQUE_DUR_EXTERNE
echo "  "
