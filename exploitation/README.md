# Opérations standard d'exploitation

Dans ce répertoire, se trouve les scripts qui permettent d'exécuter toutes les opérations standard d'exploitatioon, soit, pour chaque release : 
* `backup.sh` : 

Le backup 1/2 est réalise vers une cible : disque dur externe Seagate 500 Go, branché en USB sur le serveur hôte de virutalisation (un alienware de merde)

```bash
jbl@pc-alienware-demerde:~$ # sudo mount -t ntfs-3g /dev/sdg1 /media/jbl/disque/dur/externe/pour/bckups/kytes
jbl@pc-alienware-demerde:~$ sudo blkid
/dev/sde1: SEC_TYPE="msdos" LABEL="DellUtility" UUID="5450-4444" TYPE="vfat" PARTUUID="76055135-01"
/dev/sde2: LABEL="RECOVERY" UUID="1C749089749066F4" TYPE="ntfs" PARTUUID="76055135-02"
/dev/sde3: UUID="2c05271f-07db-462d-bbaa-c6f3216c15e6" TYPE="ext4" PARTUUID="76055135-03"
/dev/sdf1: UUID="64eb1b64-b26d-4314-bdcd-2e23f9461e0d" TYPE="ext4" PARTUUID="34fdd845-01"
/dev/sdf5: UUID="f8604e28-35f6-4234-92f1-dc9ba8aaab5b" TYPE="swap" PARTUUID="34fdd845-05"
/dev/sdf6: UUID="3bd9fe79-2189-4857-9aa8-7f95b67797c5" TYPE="ext4" PARTUUID="34fdd845-06"
/dev/sdg1: LABEL="Seagate Slim Drive" UUID="70BE639EBE635B9A" TYPE="ntfs" PARTUUID="77c975a2-01"
jbl@pc-alienware-demerde:~$ 

```

La persistance du montage du disque dur externe pourrait être réalisée avec une entrée fstab : 

```bash
UUID=70BE639EBE635B9A /media/jbl/disque/dur/externe/pour/bckups/kytes ntfs-3g  errors=remount-ro 0 1
```

Cependant, je préfère dynamiquement, dans la procédure de backup, résliser le montage à la volée, pour que mon démarrage hôte de virtualisation ne soit pas emmerdé si mon disque dur externe n'est pas branché sur port USB du serveur.

Voici une démo en interactif : 

```bash
jbl@pc-alienware-demerde:~$ sudo blkid
/dev/sde1: SEC_TYPE="msdos" LABEL="DellUtility" UUID="5450-4444" TYPE="vfat" PARTUUID="76055135-01"
/dev/sde2: LABEL="RECOVERY" UUID="1C749089749066F4" TYPE="ntfs" PARTUUID="76055135-02"
/dev/sde3: UUID="2c05271f-07db-462d-bbaa-c6f3216c15e6" TYPE="ext4" PARTUUID="76055135-03"
/dev/sdf1: UUID="64eb1b64-b26d-4314-bdcd-2e23f9461e0d" TYPE="ext4" PARTUUID="34fdd845-01"
/dev/sdf5: UUID="f8604e28-35f6-4234-92f1-dc9ba8aaab5b" TYPE="swap" PARTUUID="34fdd845-05"
/dev/sdf6: UUID="3bd9fe79-2189-4857-9aa8-7f95b67797c5" TYPE="ext4" PARTUUID="34fdd845-06"
/dev/sdg1: LABEL="Seagate Slim Drive" UUID="70BE639EBE635B9A" TYPE="ntfs" PARTUUID="77c975a2-01"
jbl@pc-alienware-demerde:~$ ls -all /media/jbl/disque/dur/externe/pour/bckups/kytes/
total 287161
drwxrwxrwx 1 root root     12288 Oct 26 18:58 .
drwxr-xr-x 3 jbl  jbl       4096 Oct 26 18:55 ..
-rwxrwxrwx 2 root root     76079 Sep 11 04:37 20180911094137.pdf
-rwxrwxrwx 2 root root    107001 Sep 11 04:38 20180911094239.pdf
-rwxrwxrwx 1 root root        30 Jul 16  2012 Autorun.inf
drwxrwxrwx 1 root root      4096 Sep 18 11:57 BOSSTEK
drwxrwxrwx 1 root root         0 Sep 18 03:57 coquelicot
drwxrwxrwx 1 root root         0 Dec 12  2017 EASE
drwxrwxrwx 1 root root     28672 Oct 26 19:03 JUSTE_POUR_JIB
drwxrwxrwx 1 root root         0 Oct 26 12:20 kytes-production-drp
-rwxrwxrwx 2 root root       790 Apr 19  2016 liste2016.xspf.lnk
-rwxrwxrwx 2 root root       879 Apr 21  2017 OpenOffice.org 2.3.lnk
drwxrwxrwx 1 root root      4096 Sep  2  2014 OUTILS.UTILISES.PAR.VINSE.EN.AFRIQUE
drwxrwxrwx 1 root root      4096 May  8  2016 $RECYCLE.BIN
-rwxrwxrwx 2 root root     14680 Oct 23  2013 Réunion Charme n°1.docx
drwxrwxrwx 1 root root         0 Mar 26  2013 Seagate
-rwxrwxrwx 2 root root 135415338 Mar  7  2013 Seagate Dashboard Installer.dmg
-rwxrwxrwx 2 root root 156167544 Mar  7  2013 Seagate Dashboard Installer.exe
-rwxrwxrwx 2 root root       297 Apr 10  2015 Seagate Slim Drive (D) - Raccourci.lnk
-rwxrwxrwx 1 root root   2184846 Feb  8  2013 SlimIcon.ico
drwxrwxrwx 1 root root      4096 Sep 13 18:58 System Volume Information
drwxrwxrwx 1 root root      4096 Apr 27  2017 Video
jbl@pc-alienware-demerde:~$ sudo umount UUID=70BE639EBE635B9A
jbl@pc-alienware-demerde:~$ ls -all /media/jbl/disque/dur/externe/pour/bckups/kytes/
total 8
drwxr-xr-x 2 jbl demerde 4096 Oct 26 18:55 .
drwxr-xr-x 3 jbl demerde 4096 Oct 26 18:55 ..
jbl@pc-alienware-demerde:~$ sudo mount -t ntfs-3g UUID=70BE639EBE635B9A /media/jbl/disque/dur/externe/pour/bckups/kytes
jbl@pc-alienware-demerde:~$ ls -all /media/jbl/disque/dur/externe/pour/bckups/kytes/
total 287161
drwxrwxrwx 1 root root     12288 Oct 26 18:58 .
drwxr-xr-x 3 jbl  jbl       4096 Oct 26 18:55 ..
-rwxrwxrwx 2 root root     76079 Sep 11 04:37 20180911094137.pdf
-rwxrwxrwx 2 root root    107001 Sep 11 04:38 20180911094239.pdf
-rwxrwxrwx 1 root root        30 Jul 16  2012 Autorun.inf
drwxrwxrwx 1 root root      4096 Sep 18 11:57 BOSSTEK
drwxrwxrwx 1 root root         0 Sep 18 03:57 coquelicot
drwxrwxrwx 1 root root         0 Dec 12  2017 EASE
drwxrwxrwx 1 root root     28672 Oct 26 19:03 JUSTE_POUR_JIB
drwxrwxrwx 1 root root         0 Oct 26 12:20 kytes-production-drp
-rwxrwxrwx 2 root root       790 Apr 19  2016 liste2016.xspf.lnk
-rwxrwxrwx 2 root root       879 Apr 21  2017 OpenOffice.org 2.3.lnk
drwxrwxrwx 1 root root      4096 Sep  2  2014 OUTILS.UTILISES.PAR.VINSE.EN.AFRIQUE
drwxrwxrwx 1 root root      4096 May  8  2016 $RECYCLE.BIN
-rwxrwxrwx 2 root root     14680 Oct 23  2013 Réunion Charme n°1.docx
drwxrwxrwx 1 root root         0 Mar 26  2013 Seagate
-rwxrwxrwx 2 root root 135415338 Mar  7  2013 Seagate Dashboard Installer.dmg
-rwxrwxrwx 2 root root 156167544 Mar  7  2013 Seagate Dashboard Installer.exe
-rwxrwxrwx 2 root root       297 Apr 10  2015 Seagate Slim Drive (D) - Raccourci.lnk
-rwxrwxrwx 1 root root   2184846 Feb  8  2013 SlimIcon.ico
drwxrwxrwx 1 root root      4096 Sep 13 18:58 System Volume Information
drwxrwxrwx 1 root root      4096 Apr 27  2017 Video
jbl@pc-alienware-demerde:~$ 
```
